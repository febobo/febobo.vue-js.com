---
title: js中的(参考线)吸附线
date: 2017-02-04 15:54:15
tags: javascript,js
description: js中的吸附线
---

最近公司需要弄一个营销平台，故调研了市场上top前几的类似系统，其中易企秀中的拖拉吸附线有点意思，也看到了一些类似于如何实现吸附线的问题，那我们到底要怎么才能实现这吸附线呢？

很简单。
首先，我们脑补一下吸附线的应用场景跟必要条件

![image](https://cloud.githubusercontent.com/assets/9276376/22617123/d5551f40-eaf7-11e6-8f17-e1bd455c8b9c.png)


1. 中心点
2. 容器
3. 什么条件下吸附
4. 对谁吸附

好了，其实只要我们知道以上的信息，想要实现吸附线其实就很简单了，

比如我们已知的容器的大小为320 ＊ 568，
将要被我们拖动的圆体为100 ＊ 100，
那么我们容器将要进行对比的数值为
x轴：［0,160,320］  三个值分别为最左边，中间，最右边
y轴：［0,284,568］  三个值分别为最上边，中间，最下边

只有当我们将圆的位置拖动到x,y轴同上对应时，这时我们会创建吸附线

公式很简单，如下

水平对应的公式

```js
// t 为要对比的值，x轴为容器的［0,160,320］， 那么这里的t 分别就是0,160,320 , left为目标元素offsetLeft
testX(t, t - left);
testX(t, t - (left + targetWidth / 2));
testX(t, t - (left + targetWidth));
```

垂直对应的公式

```js
// t 为要对比的值，y轴为容器的［0,284,568］， 那么这里的t 分别就是0,284,568 , left为目标元素offsetLeft
testY(t, t - top);
testY(t, t - (top + targetHeight / 2));
testY(t, t - (top + targetHeight));
```

这个时候我们已经知道公式了，那么让我们来创造出第一根吸附线

```js
var testX = function(t,offset){
  if(offset === 0 || '得于你心中的误差值'){
    renderGuide(t)  // 这里把position传进去直接渲染就好了
  }
}
```

好了，第一根吸附线已经完成了， 那么如果元素跟多个元素都重合了，需要创建多根吸附线，这个该怎么做呢 ？

嗯， 没事，即然我们能创建一根， 那么多根也是没问题，我们先来缕一缕，我们在前面有提到必要的条件4对谁吸附, 我们只要知道我们需要对谁吸附并将它添加到需要对比的数组里就好了 ，

我们先回过头改一下思路，比如我们的容器还有一个无素s ，

这是之前我们只需要跟容器本身对比的数值
x轴：alignX =［0,160,320］
y轴：alignY =［0,284,568］

这个时候我们在初始化的时候把容器中的需要对比的值都添加进去x轴：alignX，y轴：alignY，最然一一对比并创建出线就好了
